{% extends 'iframe_base.html' %}
{% import 'per/_models.html' as model %}
{% from 'bootstrap/utils.html' import render_static %}
{% block head %}
	<style>
		.per-content {
			height: 100%;
			width: 100%;
		}
		.per-table {
			padding: 1.2rem 1rem;
			width: 100%;
			height: 100%;
		}
		.tab-content {
			width: 100%;
			height: 100%;
		}
		.fade {
			width: 100%;
			height: 90%;
		}
		form#add-per {
			width: 100%;
			height: 100%;
		}
		td.index, th.index{
			width: 3em;
			padding-top: 1em;
		}
	</style>
{% endblock %}
{% block content %}
	<div class="iframe-content">
		<div class="search d-flex mb-2">
			<div class="title">{{ title }}</div>
		</div>
		<div class="per-content">
			<form id="add-per">
				{% include 'per/infotable.html' %}
			</form>
			<div class="input-group justify-content-end">
				<button type="submit" class="btn btn-outline-dark
				mr-3">提交</button>
				<button type="reset" class="btn btn-outline-dark
				mr-3">重置</button>
			</div>
		</div>
	</div>
{% endblock %}
{% block script %}
	<script>
        var myCount = function () {
            var privateCounter = 0;
            function changeBy(val) {
                privateCounter += val;
            }
            return {
                increment: function() {
                    changeBy(1);
                },
                decrement: function() {
                    changeBy(-1);
                },
                value: function() {
                    return privateCounter;
                }
            }
        };

        var myText = "<td class='input-group-inline input-group-sm'>" +
            "<input type='text' class='form-control' " +
            "placeholder='请输入...'>" +
            "</td>";

        var myNum = "<td class='input-group-inline input-group-sm'>" +
            "<input type='number' class='form-control' " +
            "placeholder='请输入...'>" +
            "</td>";

        var handle = {
            del: function (id) {
                console.log(id)
            }
        };


        var f_count = myCount();

        $(document).ready(function () {

            // 添加一行新的插入表格
            $('#add-family-tr').bind('click', function () {
                f_count.increment();
                var f_id = "family-" + f_count.value();
                var f_tr = $('<tr id="'+ f_id + '"></tr>');
                f_tr.append($('<td class="index">'+ f_count.value() + '</td>'));
                f_tr.append($(myText));
                f_tr.append($(myText));
                f_tr.append($(myNum));
                f_tr.append($(myText));
                f_tr.append($(myText));
                f_tr.append($("<td><button type='button' class='btn btn-link " +
                    "btn-sm' onclick=" + "handle.del('family-" + f_count
						.value() + "')" + ">删除</button></td>"));
                $('#family-tbody').append(f_tr)
            });
        });
	</script>
{% endblock %}